<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>📝 영어시험 자동 채점</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📝</text></svg>">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>

  <!-- Header -->
  <div class="header">
    <h1>📝 영어시험 자동 채점</h1>
    <div class="status">
      <span class="dot" id="statusDot"></span>
      <span id="statusText">연결 확인 중...</span>
    </div>
  </div>

  <!-- Navigation -->
  <div class="nav">
    <button class="active" data-screen="home">🏠 홈</button>
    <button data-screen="upload">📸 촬영</button>
    <button data-screen="answers">✏️ 정답</button>
    <button data-screen="result">📊 결과</button>
    <button data-screen="history">📚 기록</button>
  </div>

  <div class="main">

    <!-- ==================== HOME ==================== -->
    <div id="screen-home" class="screen active">
      <div class="card" style="text-align:center; background: linear-gradient(135deg, #EFF6FF, #F5F3FF);">
        <div style="font-size:64px; margin-bottom:12px;">📝</div>
        <h2>스마트 영어시험 채점</h2>
        <p>시험지를 촬영하면 AI가 자동으로 채점해드립니다</p>
        <button class="btn btn-primary" style="margin-top:20px;" id="btnStartGrading">
          🚀 채점 시작하기
        </button>
      </div>

      <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
        <div class="card" style="text-align:center; padding:20px;">
          <div style="font-size:28px;">📸</div>
          <h3 style="margin-top:8px;">1. 시험지 촬영</h3>
          <p style="font-size:12px;">카메라 또는 갤러리</p>
        </div>
        <div class="card" style="text-align:center; padding:20px;">
          <div style="font-size:28px;">🔍</div>
          <h3 style="margin-top:8px;">2. OCR 인식</h3>
          <p style="font-size:12px;">텍스트 자동 인식</p>
        </div>
        <div class="card" style="text-align:center; padding:20px;">
          <div style="font-size:28px;">✏️</div>
          <h3 style="margin-top:8px;">3. 정답 입력</h3>
          <p style="font-size:12px;">정답 키 설정</p>
        </div>
        <div class="card" style="text-align:center; padding:20px;">
          <div style="font-size:28px;">📊</div>
          <h3 style="margin-top:8px;">4. 자동 채점</h3>
          <p style="font-size:12px;">AI 채점 결과</p>
        </div>
      </div>
    </div>

    <!-- ==================== UPLOAD ==================== -->
    <div id="screen-upload" class="screen">
      <div class="card">
        <h2>📸 시험지 업로드</h2>
        <p style="margin-bottom:16px;">시험지 사진을 촬영하거나 갤러리에서 선택하세요</p>

        <div class="upload-zone" id="uploadZone">
          <div class="icon">📷</div>
          <div class="label">터치하여 사진 선택</div>
          <div class="sublabel">JPG, PNG 지원 · 최대 10장</div>
        </div>

        <div class="upload-btns">
          <button class="btn btn-secondary btn-sm" id="btnCamera">📷 카메라 촬영</button>
          <button class="btn btn-secondary btn-sm" id="btnGallery">🖼️ 갤러리 선택</button>
        </div>
        <input type="file" id="fileCamera" accept="image/*" capture="environment" style="display:none">
        <input type="file" id="fileGallery" accept="image/*" multiple style="display:none">

        <div class="preview-grid" id="previewGrid"></div>
        <div class="file-count" id="fileCount"></div>

        <div style="margin-top:16px;">
          <label>시험 제목 (선택)</label>
          <input type="text" id="examTitle" placeholder="예: 영어 중간고사">
        </div>

        <button class="btn btn-primary" style="margin-top:16px;" id="uploadBtn" disabled>
          📤 업로드 및 OCR 인식
        </button>
      </div>

      <div id="uploadProgress" style="display:none;" class="card">
        <div class="loading">
          <div class="spinner"></div>
          <p style="margin-top:12px;" id="uploadStatus">업로드 중...</p>
        </div>
      </div>
    </div>

    <!-- ==================== ANSWERS ==================== -->
    <div id="screen-answers" class="screen">
      <div class="card">
        <h2>✏️ 정답 입력</h2>
        <p id="answersInfo">OCR로 인식된 문항에 정답을 입력하세요</p>
      </div>

      <div id="questionList">
        <div class="empty">
          <div class="icon">📋</div>
          <p>먼저 시험지를 업로드하고 OCR 인식을 수행하세요</p>
        </div>
      </div>

      <div id="answerActions" style="display:none;">
        <div class="card" style="padding:16px;">
          <button class="btn btn-secondary btn-sm" id="btnSampleAnswers" style="margin-bottom:8px;">
            📋 샘플 정답 자동 입력
          </button>
        </div>
        <button class="btn btn-success" id="btnGrade">
          ✅ 채점하기
        </button>
      </div>

      <div id="gradingProgress" style="display:none;" class="card">
        <div class="loading">
          <div class="spinner"></div>
          <p style="margin-top:12px;">AI가 채점 중입니다...</p>
        </div>
      </div>
    </div>

    <!-- ==================== RESULT ==================== -->
    <div id="screen-result" class="screen">
      <div id="resultContent">
        <div class="empty">
          <div class="icon">📊</div>
          <p>아직 채점 결과가 없습니다</p>
        </div>
      </div>
    </div>

    <!-- ==================== HISTORY ==================== -->
    <div id="screen-history" class="screen">
      <div class="card" style="display:flex; justify-content:space-between; align-items:center; padding:16px;">
        <h2 style="margin:0;">📚 채점 기록</h2>
        <button class="btn btn-secondary btn-sm" id="btnRefreshHistory">🔄 새로고침</button>
      </div>
      <div id="historyList">
        <div class="loading">
          <div class="spinner"></div>
          <p style="margin-top:12px;">불러오는 중...</p>
        </div>
      </div>
    </div>

  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <script src="/app.js"></script>
</body>
</html>
